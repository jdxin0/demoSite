/*
 * Copyright (C) 2004 Baron Schwartz <baron at sequent dot org>
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as published by the
 * Free Software Foundation, version 2.1.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more
 * details.
 */

/*
 * Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)
 *
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.1.3
 *
 * Requires: 1.2.2+
 */

!function($){var default_options={i18n:{ru:{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayOfWeek:["Вск","Пн","Вт","Ср","Чт","Пт","Сб"]},en:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},de:{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dayOfWeek:["So","Mo","Di","Mi","Do","Fr","Sa"]},nl:{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dayOfWeek:["zo","ma","di","wo","do","vr","za"]},tr:{months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dayOfWeek:["Paz","Pts","Sal","Çar","Per","Cum","Cts"]},fr:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dayOfWeek:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},es:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dayOfWeek:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]},th:{months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],dayOfWeek:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},pl:{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],dayOfWeek:["nd","pn","wt","śr","cz","pt","sb"]},pt:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},ch:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},se:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeek:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},kr:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeek:["일","월","화","수","목","금","토"]},it:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dayOfWeek:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]}},value:"",lang:"en",format:"Y/m/d H:i",formatTime:"H:i",formatDate:"Y/m/d",step:60,closeOnDateSelect:0,closeOnWithoutClick:!0,timepicker:!0,datepicker:!0,minDate:!1,maxDate:!1,minTime:!1,maxTime:!1,allowTimes:[],opened:!1,inline:!1,onSelectDate:function(){},onSelectTime:function(){},onChangeMonth:function(){},onChangeDateTime:function(){},onShow:function(){},onClose:function(){},onGenerate:function(){},withoutCopyright:!0,inverseButton:!1,hours12:!1,next:"xdsoft_next",prev:"xdsoft_prev",dayOfWeekStart:0,timeHeightInTimePicker:25,timepickerScrollbar:!0,todayButton:!0,defaultSelect:!0,scrollMonth:!0,scrollTime:!0,scrollInput:!0,mask:!1,validateOnBlur:!0,allowBlank:!1,yearStart:1950,yearEnd:2050,style:"",id:"",roundTime:"round",className:"",weekends:[],yearOffset:0};Array.prototype.indexOf||(Array.prototype.indexOf=function(obj,start){for(var i=start||0,j=this.length;i<j;i++)if(this[i]===obj)return i;return-1}),$.fn.xdsoftScroller=function(_percent){return this.each(function(){var timeboxparent=$(this);if(!$(this).hasClass("xdsoft_scroller_box")){var pointerEventToXY=function(e){var out={x:0,y:0};if("touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){var touch=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];out.x=touch.pageX,out.y=touch.pageY}else"mousedown"!=e.type&&"mouseup"!=e.type&&"mousemove"!=e.type&&"mouseover"!=e.type&&"mouseout"!=e.type&&"mouseenter"!=e.type&&"mouseleave"!=e.type||(out.x=e.pageX,out.y=e.pageY);return out},move=0,timebox=timeboxparent.children().eq(0),parentHeight=timeboxparent[0].clientHeight,height=timebox[0].offsetHeight,scrollbar=$('<div class="xdsoft_scrollbar"></div>'),scroller=$('<div class="xdsoft_scroller"></div>'),maximumOffset=100,start=!1;scrollbar.append(scroller),timeboxparent.addClass("xdsoft_scroller_box").append(scrollbar),scroller.on("mousedown.xdsoft_scroller",function(event){parentHeight||timeboxparent.trigger("resize_scroll.xdsoft_scroller",[_percent]);var pageY=event.pageY,top=parseInt(scroller.css("margin-top")),h1=scrollbar[0].offsetHeight;$(document.body).addClass("xdsoft_noselect"),$([document.body,window]).on("mouseup.xdsoft_scroller",function arguments_callee(){$([document.body,window]).off("mouseup.xdsoft_scroller",arguments_callee).off("mousemove.xdsoft_scroller",move).removeClass("xdsoft_noselect")}),$(document.body).on("mousemove.xdsoft_scroller",move=function(event){var offset=event.pageY-pageY+top;offset<0&&(offset=0),offset+scroller[0].offsetHeight>h1&&(offset=h1-scroller[0].offsetHeight),timeboxparent.trigger("scroll_element.xdsoft_scroller",[maximumOffset?offset/maximumOffset:0])})}),timeboxparent.on("scroll_element.xdsoft_scroller",function(event,percent){parentHeight||timeboxparent.trigger("resize_scroll.xdsoft_scroller",[percent,!0]),percent=percent>1?1:percent<0||isNaN(percent)?0:percent,scroller.css("margin-top",maximumOffset*percent),timebox.css("marginTop",-parseInt((height-parentHeight)*percent))}).on("resize_scroll.xdsoft_scroller",function(event,_percent,noTriggerScroll){parentHeight=timeboxparent[0].clientHeight,height=timebox[0].offsetHeight;var percent=parentHeight/height,sh=percent*scrollbar[0].offsetHeight;percent>1?scroller.hide():(scroller.show(),scroller.css("height",parseInt(sh>10?sh:10)),maximumOffset=scrollbar[0].offsetHeight-scroller[0].offsetHeight,!0!==noTriggerScroll&&timeboxparent.trigger("scroll_element.xdsoft_scroller",[_percent||Math.abs(parseInt(timebox.css("marginTop")))/(height-parentHeight)]))}),timeboxparent.mousewheel&&timeboxparent.mousewheel(function(event,delta,deltaX,deltaY){var top=Math.abs(parseInt(timebox.css("marginTop")));return timeboxparent.trigger("scroll_element.xdsoft_scroller",[(top-20*delta)/(height-parentHeight)]),event.stopPropagation(),!1}),timeboxparent.on("touchstart",function(event){start=pointerEventToXY(event)}),timeboxparent.on("touchmove",function(event){if(start){var coord=pointerEventToXY(event),top=Math.abs(parseInt(timebox.css("marginTop")));timeboxparent.trigger("scroll_element.xdsoft_scroller",[(top-(coord.y-start.y))/(height-parentHeight)]),event.stopPropagation(),event.preventDefault()}}),timeboxparent.on("touchend touchcancel",function(event){start=!1})}timeboxparent.trigger("resize_scroll.xdsoft_scroller",[_percent])})},$.fn.datetimepicker=function(opt){var ctrlDown=!1,options=$.isPlainObject(opt)||!opt?$.extend(!0,{},default_options,opt):$.extend({},default_options),createDateTimePicker=function(input){var datetimepicker=$("<div "+(options.id?'id="'+options.id+'"':"")+" "+(options.style?'style="'+options.style+'"':"")+' class="xdsoft_datetimepicker xdsoft_noselect '+options.className+'"></div>'),xdsoft_copyright=$('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),datepicker=$('<div class="xdsoft_datepicker active"></div>'),mounth_picker=$('<div class="xdsoft_mounthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span></div><div class="xdsoft_label xdsoft_year"><span></span></div><button type="button" class="xdsoft_next"></button></div>'),calendar=$('<div class="xdsoft_calendar"></div>'),timepicker=$('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),timeboxparent=timepicker.find(".xdsoft_time_box").eq(0),timebox=$('<div class="xdsoft_time_variant"></div>'),scrollbar=$('<div class="xdsoft_scrollbar"></div>'),monthselect=($('<div class="xdsoft_scroller"></div>'),$('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>')),yearselect=$('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>');mounth_picker.find(".xdsoft_month span").after(monthselect),mounth_picker.find(".xdsoft_year span").after(yearselect),mounth_picker.find(".xdsoft_month,.xdsoft_year").on("mousedown.xdsoft",function(event){mounth_picker.find(".xdsoft_select").hide();var select=$(this).find(".xdsoft_select").eq(0),val=0,top=0;_xdsoft_datetime.currentTime&&(val=_xdsoft_datetime.currentTime[$(this).hasClass("xdsoft_month")?"getMonth":"getFullYear"]()),select.show();for(var items=select.find("div.xdsoft_option"),i=0;i<items.length&&items.eq(i).data("value")!=val;i++)top+=items[0].offsetHeight;return select.xdsoftScroller(top/(select.children()[0].offsetHeight-select[0].clientHeight)),event.stopPropagation(),!1}),mounth_picker.find(".xdsoft_select").xdsoftScroller().on("mousedown.xdsoft",function(event){event.stopPropagation(),event.preventDefault()}).on("mousedown.xdsoft",".xdsoft_option",function(event){_xdsoft_datetime&&_xdsoft_datetime.currentTime&&_xdsoft_datetime.currentTime[$(this).parent().parent().hasClass("xdsoft_monthselect")?"setMonth":"setFullYear"]($(this).data("value")),$(this).parent().parent().hide(),datetimepicker.trigger("xchange.xdsoft"),options.onChangeMonth&&options.onChangeMonth.call&&options.onChangeMonth.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input"))}),datetimepicker.setOptions=function(_options){options=$.extend(!0,{},options,_options),!options.open&&!options.opened||options.inline||input.trigger("open.xdsoft"),options.inline&&(datetimepicker.addClass("xdsoft_inline"),input.after(datetimepicker).hide(),datetimepicker.trigger("afterOpen.xdsoft")),options.inverseButton&&(options.next="xdsoft_prev",options.prev="xdsoft_next"),options.datepicker?datepicker.addClass("active"):datepicker.removeClass("active"),options.timepicker?timepicker.addClass("active"):timepicker.removeClass("active"),options.value&&(input&&input.val&&input.val(options.value),_xdsoft_datetime.setCurrentTime(options.value)),isNaN(options.dayOfWeekStart)||parseInt(options.dayOfWeekStart)<0||parseInt(options.dayOfWeekStart)>6?options.dayOfWeekStart=0:options.dayOfWeekStart=parseInt(options.dayOfWeekStart),options.timepickerScrollbar||scrollbar.hide();var timeOffset,tmpDate=[];if(options.minDate&&(tmpDate=/^-(.*)$/.exec(options.minDate))&&(tmpDate=Date.parseDate(tmpDate[1],options.formatDate))&&(timeOffset=tmpDate.getTime()+-1*tmpDate.getTimezoneOffset()*6e4,options.minDate=new Date(_xdsoft_datetime.now().getTime()-timeOffset).dateFormat(options.formatDate)),options.maxDate&&(tmpDate=/^\+(.*)$/.exec(options.maxDate))&&(tmpDate=Date.parseDate(tmpDate[1],options.formatDate))&&(timeOffset=tmpDate.getTime()+-1*tmpDate.getTimezoneOffset()*6e4,options.maxDate=new Date(_xdsoft_datetime.now().getTime()+timeOffset).dateFormat(options.formatDate)),mounth_picker.find(".xdsoft_today_button").css("visibility",options.todayButton?"visible":"hidden"),options.mask){var getCaretPos=function(input){try{if(document.selection&&document.selection.createRange){return document.selection.createRange().getBookmark().charCodeAt(2)-2}if(input.setSelectionRange)return input.selectionStart}catch(e){return 0}},setCaretPos=function(node,pos){var node="string"==typeof node||node instanceof String?document.getElementById(node):node;if(!node)return!1;if(node.createTextRange){var textRange=node.createTextRange();return textRange.collapse(!0),textRange.moveEnd(pos),textRange.moveStart(pos),textRange.select(),!0}return!!node.setSelectionRange&&(node.setSelectionRange(pos,pos),!0)},isValidValue=function(mask,value){var reg=mask.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g,"\\$1").replace(/_/g,"{digit+}").replace(/([0-9]{1})/g,"{digit$1}").replace(/\{digit([0-9]{1})\}/g,"[0-$1_]{1}").replace(/\{digit[\+]\}/g,"[0-9_]{1}");return RegExp(reg).test(value)};switch(input.off("keydown.xdsoft"),!0){case!0===options.mask:options.mask=options.format.replace(/Y/g,"9999").replace(/F/g,"9999").replace(/m/g,"19").replace(/d/g,"39").replace(/H/g,"29").replace(/i/g,"59").replace(/s/g,"59");case"string"==$.type(options.mask):isValidValue(options.mask,input.val())||input.val(options.mask.replace(/[0-9]/g,"_")),input.on("keydown.xdsoft",function(event){var val=this.value,key=event.which;switch(!0){case key>=48&&key<=57||key>=96&&key<=105||8==key||46==key:var pos=getCaretPos(this),digit=8!=key&&46!=key?String.fromCharCode(96<=key&&key<=105?key-48:key):"_";for(8!=key&&46!=key||!pos||(pos--,digit="_");/[^0-9_]/.test(options.mask.substr(pos,1))&&pos<options.mask.length&&pos>0;)pos+=8==key||46==key?-1:1;if(val=val.substr(0,pos)+digit+val.substr(pos+1),""==$.trim(val))val=options.mask.replace(/[0-9]/g,"_");else if(pos==options.mask.length)break;for(pos+=8==key||46==key?0:1;/[^0-9_]/.test(options.mask.substr(pos,1))&&pos<options.mask.length&&pos>0;)pos+=8==key||46==key?-1:1;isValidValue(options.mask,val)?(this.value=val,setCaretPos(this,pos)):""==$.trim(val)?this.value=options.mask.replace(/[0-9]/g,"_"):input.trigger("error_input.xdsoft");break;case!!~[65,67,86,90,89].indexOf(key)&&ctrlDown:case!!~[27,38,40,37,39,116,17,9,13].indexOf(key):return!0}return event.preventDefault(),!1})}}options.validateOnBlur&&input.off("blur.xdsoft").on("blur.xdsoft",function(){options.allowBlank&&!$.trim($(this).val()).length?($(this).val(null),datetimepicker.data("xdsoft_datetime").empty()):Date.parseDate($(this).val(),options.format)?datetimepicker.data("xdsoft_datetime").setCurrentTime($(this).val()):($(this).val(_xdsoft_datetime.now().dateFormat(options.format)),datetimepicker.data("xdsoft_datetime").setCurrentTime($(this).val())),datetimepicker.trigger("changedatetime.xdsoft")}),options.dayOfWeekStartPrev=0==options.dayOfWeekStart?6:options.dayOfWeekStart-1,datetimepicker.trigger("xchange.xdsoft")},datetimepicker.data("options",options).on("mousedown.xdsoft",function(event){return event.stopPropagation(),event.preventDefault(),yearselect.hide(),monthselect.hide(),!1});var scroll_element=timepicker.find(".xdsoft_time_box");scroll_element.append(timebox),scroll_element.xdsoftScroller(),datetimepicker.on("afterOpen.xdsoft",function(){scroll_element.xdsoftScroller()}),datetimepicker.append(datepicker).append(timepicker),!0!==options.withoutCopyright&&datetimepicker.append(xdsoft_copyright),datepicker.append(mounth_picker).append(calendar),$("body").append(datetimepicker);var _xdsoft_datetime=new function(){var _this=this;_this.now=function(){var d=new Date;return options.yearOffset&&d.setFullYear(d.getFullYear()+options.yearOffset),d},_this.currentTime=this.now(),_this.isValidDate=function(d){return"[object Date]"===Object.prototype.toString.call(d)&&!isNaN(d.getTime())},_this.setCurrentTime=function(dTime){_this.currentTime="string"==typeof dTime?_this.strtodatetime(dTime):_this.isValidDate(dTime)?dTime:_this.now(),datetimepicker.trigger("xchange.xdsoft")},_this.empty=function(){_this.currentTime=null},_this.getCurrentTime=function(dTime){return _this.currentTime},_this.nextMonth=function(){var month=_this.currentTime.getMonth()+1;return 12==month&&(_this.currentTime.setFullYear(_this.currentTime.getFullYear()+1),month=0),_this.currentTime.setDate(Math.min(Date.daysInMonth[month],_this.currentTime.getDate())),_this.currentTime.setMonth(month),options.onChangeMonth&&options.onChangeMonth.call&&options.onChangeMonth.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input")),datetimepicker.trigger("xchange.xdsoft"),month},_this.prevMonth=function(){var month=_this.currentTime.getMonth()-1;return-1==month&&(_this.currentTime.setFullYear(_this.currentTime.getFullYear()-1),month=11),_this.currentTime.setDate(Math.min(Date.daysInMonth[month],_this.currentTime.getDate())),_this.currentTime.setMonth(month),options.onChangeMonth&&options.onChangeMonth.call&&options.onChangeMonth.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input")),datetimepicker.trigger("xchange.xdsoft"),month},_this.strtodatetime=function(sDateTime){var currentTime=sDateTime?Date.parseDate(sDateTime,options.format):_this.now();return _this.isValidDate(currentTime)||(currentTime=_this.now()),currentTime},_this.strtodate=function(sDate){var currentTime=sDate?Date.parseDate(sDate,options.formatDate):_this.now();return _this.isValidDate(currentTime)||(currentTime=_this.now()),currentTime},_this.strtotime=function(sTime){var currentTime=sTime?Date.parseDate(sTime,options.formatTime):_this.now();return _this.isValidDate(currentTime)||(currentTime=_this.now()),currentTime},_this.str=function(){return _this.currentTime.dateFormat(options.format)}};mounth_picker.find(".xdsoft_today_button").on("mousedown.xdsoft",function(){datetimepicker.data("changed",!0),_xdsoft_datetime.setCurrentTime(0),datetimepicker.trigger("afterOpen.xdsoft")}).on("dblclick.xdsoft",function(){input.val(_xdsoft_datetime.str()),datetimepicker.trigger("close.xdsoft")}),mounth_picker.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var $this=$(this),timer=0,stop=!1;!function arguments_callee1(v){_xdsoft_datetime.currentTime.getMonth();$this.hasClass(options.next)?_xdsoft_datetime.nextMonth():$this.hasClass(options.prev)&&_xdsoft_datetime.prevMonth(),!stop&&(timer=setTimeout(arguments_callee1,v||100))}(500),$([document.body,window]).on("mouseup.xdsoft",function arguments_callee2(){clearTimeout(timer),stop=!0,$([document.body,window]).off("mouseup.xdsoft",arguments_callee2)})}),timepicker.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var $this=$(this),timer=0,stop=!1,period=110;!function arguments_callee4(v){var pheight=timeboxparent[0].clientHeight,height=timebox[0].offsetHeight,top=Math.abs(parseInt(timebox.css("marginTop")));$this.hasClass(options.next)&&height-pheight-options.timeHeightInTimePicker>=top?timebox.css("marginTop","-"+(top+options.timeHeightInTimePicker)+"px"):$this.hasClass(options.prev)&&top-options.timeHeightInTimePicker>=0&&timebox.css("marginTop","-"+(top-options.timeHeightInTimePicker)+"px"),timeboxparent.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(timebox.css("marginTop"))/(height-pheight))]),period=period>10?10:period-10,!stop&&(timer=setTimeout(arguments_callee4,v||period))}(500),$([document.body,window]).on("mouseup.xdsoft",function arguments_callee5(){clearTimeout(timer),stop=!0,$([document.body,window]).off("mouseup.xdsoft",arguments_callee5)})}),datetimepicker.on("xchange.xdsoft",function(event){for(var table="",start=new Date(_xdsoft_datetime.currentTime.getFullYear(),_xdsoft_datetime.currentTime.getMonth(),1,12,0,0),i=0,today=_xdsoft_datetime.now();start.getDay()!=options.dayOfWeekStart;)start.setDate(start.getDate()-1);table+="<table><thead><tr>";for(var j=0;j<7;j++)table+="<th>"+options.i18n[options.lang].dayOfWeek[j+options.dayOfWeekStart>6?0:j+options.dayOfWeekStart]+"</th>";table+="</tr></thead>",table+="<tbody><tr>";var maxDate=!1,minDate=!1;!1!==options.maxDate&&(maxDate=_xdsoft_datetime.strtodate(options.maxDate),maxDate=new Date(maxDate.getFullYear(),maxDate.getMonth(),maxDate.getDate(),23,59,59,999)),!1!==options.minDate&&(minDate=_xdsoft_datetime.strtodate(options.minDate),minDate=new Date(minDate.getFullYear(),minDate.getMonth(),minDate.getDate()));for(var d,y,m,classes=[];i<_xdsoft_datetime.currentTime.getDaysInMonth()||start.getDay()!=options.dayOfWeekStart||_xdsoft_datetime.currentTime.getMonth()==start.getMonth();)classes=[],i++,d=start.getDate(),y=start.getFullYear(),m=start.getMonth(),classes.push("xdsoft_date"),(!1!==maxDate&&start>maxDate||!1!==minDate&&start<minDate)&&classes.push("xdsoft_disabled"),_xdsoft_datetime.currentTime.getMonth()!=m&&classes.push("xdsoft_other_month"),(options.defaultSelect||datetimepicker.data("changed"))&&_xdsoft_datetime.currentTime.dateFormat("d.m.Y")==start.dateFormat("d.m.Y")&&classes.push("xdsoft_current"),today.dateFormat("d.m.Y")==start.dateFormat("d.m.Y")&&classes.push("xdsoft_today"),(0==start.getDay()||6==start.getDay()||~options.weekends.indexOf(start.dateFormat("d.m.Y")))&&classes.push("xdsoft_weekend"),table+='<td data-date="'+d+'" data-month="'+m+'" data-year="'+y+'" class="xdsoft_date xdsoft_day_of_week'+start.getDay()+" "+classes.join(" ")+'"><div>'+d+"</div></td>",start.getDay()==options.dayOfWeekStartPrev&&(table+="</tr>"),start.setDate(d+1);table+="</tbody></table>",calendar.html(table),mounth_picker.find(".xdsoft_label span").eq(0).text(options.i18n[options.lang].months[_xdsoft_datetime.currentTime.getMonth()]),mounth_picker.find(".xdsoft_label span").eq(1).text(_xdsoft_datetime.currentTime.getFullYear());var time="",h="",m="",line_time=function(h,m){var now=_xdsoft_datetime.now();now.setHours(h),h=parseInt(now.getHours()),now.setMinutes(m),m=parseInt(now.getMinutes()),classes=[],(!1!==options.maxTime&&_xdsoft_datetime.strtotime(options.maxTime).getTime()<now.getTime()||!1!==options.minTime&&_xdsoft_datetime.strtotime(options.minTime).getTime()>now.getTime())&&classes.push("xdsoft_disabled"),(options.defaultSelect||datetimepicker.data("changed"))&&parseInt(_xdsoft_datetime.currentTime.getHours())==parseInt(h)&&(options.step>59||Math[options.roundTime](_xdsoft_datetime.currentTime.getMinutes()/options.step)*options.step==parseInt(m))&&classes.push("xdsoft_current"),parseInt(today.getHours())==parseInt(h)&&parseInt(today.getMinutes())==parseInt(m)&&classes.push("xdsoft_today"),time+='<div class="xdsoft_time '+classes.join(" ")+'" data-hour="'+h+'" data-minute="'+m+'">'+now.dateFormat(options.formatTime)+"</div>"};if(options.allowTimes&&$.isArray(options.allowTimes)&&options.allowTimes.length)for(var i=0;i<options.allowTimes.length;i++)h=_xdsoft_datetime.strtotime(options.allowTimes[i]).getHours(),m=_xdsoft_datetime.strtotime(options.allowTimes[i]).getMinutes(),line_time(h,m);else for(var i=0,j=0;i<(options.hours12?12:24);i++)for(j=0;j<60;j+=options.step)h=(i<10?"0":"")+i,m=(j<10?"0":"")+j,line_time(h,m);timebox.html(time);var opt="",i=0;for(i=parseInt(options.yearStart,10)+options.yearOffset;i<=parseInt(options.yearEnd,10)+options.yearOffset;i++)opt+='<div class="xdsoft_option '+(_xdsoft_datetime.currentTime.getFullYear()==i?"xdsoft_current":"")+'" data-value="'+i+'">'+i+"</div>";for(yearselect.children().eq(0).html(opt),i=0,opt="";i<=11;i++)opt+='<div class="xdsoft_option '+(_xdsoft_datetime.currentTime.getMonth()==i?"xdsoft_current":"")+'" data-value="'+i+'">'+options.i18n[options.lang].months[i]+"</div>";monthselect.children().eq(0).html(opt),$(this).trigger("generate.xdsoft"),event.stopPropagation()}).on("afterOpen.xdsoft",function(){if(options.timepicker&&timebox.find(".xdsoft_current").length){var pheight=timeboxparent[0].clientHeight,height=timebox[0].offsetHeight,top=timebox.find(".xdsoft_current").index()*options.timeHeightInTimePicker+1;height-pheight<top&&(top=height-pheight),timebox.css("marginTop","-"+parseInt(top)+"px"),timeboxparent.trigger("scroll_element.xdsoft_scroller",[parseInt(top)/(height-pheight)])}});var timerclick=0;calendar.on("click.xdsoft","td",function(){timerclick++;var $this=$(this),currentTime=_xdsoft_datetime.currentTime;if($this.hasClass("xdsoft_disabled"))return!1;currentTime.setFullYear($this.data("year")),currentTime.setMonth($this.data("month")),currentTime.setDate($this.data("date")),datetimepicker.trigger("select.xdsoft",[currentTime]),input.val(_xdsoft_datetime.str()),(timerclick>1||!0===options.closeOnDateSelect||0===options.closeOnDateSelect&&!options.timepicker)&&!options.inline&&datetimepicker.trigger("close.xdsoft"),options.onSelectDate&&options.onSelectDate.call&&options.onSelectDate.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input")),datetimepicker.data("changed",!0),datetimepicker.trigger("xchange.xdsoft"),datetimepicker.trigger("changedatetime.xdsoft"),setTimeout(function(){timerclick=0},200)}),timebox.on("click.xdsoft","div",function(){var $this=$(this),currentTime=_xdsoft_datetime.currentTime;if($this.hasClass("xdsoft_disabled"))return!1;currentTime.setHours($this.data("hour")),currentTime.setMinutes($this.data("minute")),datetimepicker.trigger("select.xdsoft",[currentTime]),datetimepicker.data("input").val(_xdsoft_datetime.str()),!options.inline&&datetimepicker.trigger("close.xdsoft"),options.onSelectTime&&options.onSelectTime.call&&options.onSelectTime.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input")),datetimepicker.data("changed",!0),datetimepicker.trigger("xchange.xdsoft"),datetimepicker.trigger("changedatetime.xdsoft")}),datetimepicker.mousewheel&&datepicker.mousewheel(function(event,delta,deltaX,deltaY){return!options.scrollMonth||(delta<0?_xdsoft_datetime.nextMonth():_xdsoft_datetime.prevMonth(),!1)}),datetimepicker.mousewheel&&timeboxparent.unmousewheel().mousewheel(function(event,delta,deltaX,deltaY){if(!options.scrollTime)return!0;var pheight=timeboxparent[0].clientHeight,height=timebox[0].offsetHeight,top=Math.abs(parseInt(timebox.css("marginTop"))),fl=!0;return delta<0&&height-pheight-options.timeHeightInTimePicker>=top?(timebox.css("marginTop","-"+(top+options.timeHeightInTimePicker)+"px"),fl=!1):delta>0&&top-options.timeHeightInTimePicker>=0&&(timebox.css("marginTop","-"+(top-options.timeHeightInTimePicker)+"px"),fl=!1),timeboxparent.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(timebox.css("marginTop"))/(height-pheight))]),event.stopPropagation(),fl}),datetimepicker.on("changedatetime.xdsoft",function(){options.onChangeDateTime&&options.onChangeDateTime.call&&options.onChangeDateTime.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input"))}).on("generate.xdsoft",function(){options.onGenerate&&options.onGenerate.call&&options.onGenerate.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input"))});var current_time_index=0;input.mousewheel&&input.mousewheel(function(event,delta,deltaX,deltaY){return!options.scrollInput||(!options.datepicker&&options.timepicker?(current_time_index=timebox.find(".xdsoft_current").length?timebox.find(".xdsoft_current").eq(0).index():0,current_time_index+delta>=0&&current_time_index+delta<timebox.children().length&&(current_time_index+=delta),timebox.children().eq(current_time_index).length&&timebox.children().eq(current_time_index).trigger("mousedown"),!1):options.datepicker&&!options.timepicker?(datepicker.trigger(event,[delta,deltaX,deltaY]),input.val&&input.val(_xdsoft_datetime.str()),datetimepicker.trigger("changedatetime.xdsoft"),!1):void 0)});var setPos=function(){var offset=datetimepicker.data("input").offset(),top=offset.top+datetimepicker.data("input")[0].offsetHeight-1,left=offset.left;top+datetimepicker[0].offsetHeight>$(window).height()+$(window).scrollTop()&&(top=offset.top-datetimepicker[0].offsetHeight+1),left+datetimepicker[0].offsetWidth>$(window).width()&&(left=offset.left-datetimepicker[0].offsetWidth+datetimepicker.data("input")[0].offsetWidth),datetimepicker.css({left:left,top:top})};datetimepicker.on("open.xdsoft",function(){var onShow=!0;options.onShow&&options.onShow.call&&(onShow=options.onShow.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input"))),!1!==onShow&&(datetimepicker.show(),datetimepicker.trigger("afterOpen.xdsoft"),setPos(),$(window).off("resize.xdsoft",setPos).on("resize.xdsoft",setPos),options.closeOnWithoutClick&&$([document.body,window]).on("mousedown.xdsoft",function arguments_callee6(){datetimepicker.trigger("close.xdsoft"),$([document.body,window]).off("mousedown.xdsoft",arguments_callee6)}))}).on("close.xdsoft",function(event){var onClose=!0;options.onClose&&options.onClose.call&&(onClose=options.onClose.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data("input"))),!1===onClose||options.opened||options.inline||datetimepicker.hide(),event.stopPropagation()}).data("input",input);var timer=0;datetimepicker.data("xdsoft_datetime",_xdsoft_datetime),datetimepicker.setOptions(options);var ct=options.value?options.value:input&&input.val&&input.val()?input.val():"";ct&&_xdsoft_datetime.isValidDate(ct=Date.parseDate(ct,options.format))?datetimepicker.data("changed",!0):ct="",_xdsoft_datetime.setCurrentTime(ct||0),datetimepicker.trigger("afterOpen.xdsoft"),input.data("xdsoft_datetimepicker",datetimepicker).on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function(event){input.is(":disabled")||input.is(":hidden")||!input.is(":visible")||(clearTimeout(timer),timer=setTimeout(function(){input.is(":disabled")||input.is(":hidden")||!input.is(":visible")||(_xdsoft_datetime.setCurrentTime(input&&input.val&&input.val()?input.val():0),datetimepicker.trigger("open.xdsoft"))},100))}).on("keydown.xdsoft",function(event){var key=(this.value,event.which);switch(!0){case!!~[13].indexOf(key):var elementSelector=$("input:visible,textarea:visible");return datetimepicker.trigger("close.xdsoft"),elementSelector.eq(elementSelector.index(this)+1).focus(),!1;case!!~[9].indexOf(key):return datetimepicker.trigger("close.xdsoft"),!0}})},destroyDateTimePicker=function(input){var datetimepicker=input.data("xdsoft_datetimepicker");datetimepicker&&(datetimepicker.data("xdsoft_datetime",null),datetimepicker.remove(),input.data("xdsoft_datetimepicker",null).off("open.xdsoft focusin.xdsoft focusout.xdsoft mousedown.xdsoft blur.xdsoft keydown.xdsoft"),$(window).off("resize.xdsoft"),$([window,document.body]).off("mousedown.xdsoft"),input.unmousewheel&&input.unmousewheel())};return $(document).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl",function(e){17==e.keyCode&&(ctrlDown=!0)}).on("keyup.xdsoftctrl",function(e){17==e.keyCode&&(ctrlDown=!1)}),this.each(function(){var datetimepicker;if(datetimepicker=$(this).data("xdsoft_datetimepicker")){if("string"===$.type(opt))switch(opt){case"show":$(this).select().focus(),datetimepicker.trigger("open.xdsoft");break;case"hide":datetimepicker.trigger("close.xdsoft");break;case"destroy":destroyDateTimePicker($(this));break;case"reset":this.value=this.defaultValue,this.value&&datetimepicker.data("xdsoft_datetime").isValidDate(Date.parseDate(this.value,options.format))||datetimepicker.data("changed",!1),datetimepicker.data("xdsoft_datetime").setCurrentTime(this.value)}else datetimepicker.setOptions(opt);return 0}"string"!==$.type(opt)&&createDateTimePicker($(this))})}}(jQuery),Date.parseFunctions={count:0},Date.parseRegexes=[],Date.formatFunctions={count:0},Date.prototype.dateFormat=function(format){return null==Date.formatFunctions[format]&&Date.createNewFormat(format),this[Date.formatFunctions[format]]()},Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;for(var code="Date.prototype."+funcName+" = function() {return ",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,code+="'"+String.escape(ch)+"' + "):code+=Date.getFormatCode(ch):special=!0;eval(code.substring(0,code.length-3)+";}")},Date.getFormatCode=function(character){switch(character){case"d":return"String.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"String.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":
return"this.getHours() + ";case"h":return"String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"String.leftPad(this.getHours(), 2, '0') + ";case"i":return"String.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"String.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+String.escape(character)+"' + "}},Date.parseDate=function(input,format){null==Date.parseFunctions[format]&&Date.createParser(format);var func=Date.parseFunctions[format];return Date[func](input)},Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++,regexNum=Date.parseRegexes.length,currentGroup=1;Date.parseFunctions[format]=funcName;for(var code="Date."+funcName+" = function(input) {\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {",regex="",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,regex+=String.escape(ch)):(obj=Date.formatCodeToRegex(ch,currentGroup),currentGroup+=obj.g,regex+=obj.s,obj.g&&obj.c&&(code+=obj.c)):special=!0;code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}",Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$"),eval(code)},Date.formatCodeToRegex=function(character,currentGroup){switch(character){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:0,c:null,s:"(?:\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+currentGroup+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+currentGroup+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+currentGroup+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+currentGroup+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+currentGroup+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+currentGroup+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:String.escape(character)}}},Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+String.leftPad(Math.abs(this.getTimezoneOffset())%60,2,"0")},Date.prototype.getDayOfYear=function(){var num=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var i=0;i<this.getMonth();++i)num+=Date.daysInMonth[i];return num+this.getDate()-1},Date.prototype.getWeekOfYear=function(){var now=this.getDayOfYear()+(4-this.getDay()),jan1=new Date(this.getFullYear(),0,1),then=7-jan1.getDay()+4;return document.write(then),String.leftPad((now-then)/7+1,2,"0")},Date.prototype.isLeapYear=function(){var year=this.getFullYear();return 0==(3&year)&&(year%100||year%400==0&&year)},Date.prototype.getFirstDayOfMonth=function(){var day=(this.getDay()-(this.getDate()-1))%7;return day<0?day+7:day},Date.prototype.getLastDayOfMonth=function(){var day=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return day<0?day+7:day},Date.prototype.getDaysInMonth=function(){return Date.daysInMonth[1]=this.isLeapYear()?29:28,Date.daysInMonth[this.getMonth()]},Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},String.escape=function(string){return string.replace(/('|\\)/g,"\\$1")},String.leftPad=function(val,size,ch){var result=new String(val);for(null==ch&&(ch=" ");result.length<size;)result=ch+result;return result},Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.y2kYear=50,Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"},function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports?module.exports=factory:factory(jQuery)}(function($){function handler(event){var fn,orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,absDeltaXY=0;return event=$.event.fix(orgEvent),event.type="mousewheel",orgEvent.wheelDelta&&(delta=orgEvent.wheelDelta),orgEvent.detail&&(delta=-1*orgEvent.detail),orgEvent.deltaY&&(deltaY=-1*orgEvent.deltaY,delta=deltaY),orgEvent.deltaX&&(deltaX=orgEvent.deltaX,delta=-1*deltaX),orgEvent.wheelDeltaY!==undefined&&(deltaY=orgEvent.wheelDeltaY),orgEvent.wheelDeltaX!==undefined&&(deltaX=-1*orgEvent.wheelDeltaX),absDelta=Math.abs(delta),(!lowestDelta||absDelta<lowestDelta)&&(lowestDelta=absDelta),absDeltaXY=Math.max(Math.abs(deltaY),Math.abs(deltaX)),(!lowestDeltaXY||absDeltaXY<lowestDeltaXY)&&(lowestDeltaXY=absDeltaXY),fn=delta>0?"floor":"ceil",delta=Math[fn](delta/lowestDelta),deltaX=Math[fn](deltaX/lowestDeltaXY),deltaY=Math[fn](deltaY/lowestDeltaXY),args.unshift(event,delta,deltaX,deltaY),($.event.dispatch||$.event.handle).apply(this,args)}var lowestDelta,lowestDeltaXY,toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],toBind="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if($.event.fixHooks)for(var i=toFix.length;i;)$.event.fixHooks[toFix[--i]]=$.event.mouseHooks;$.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var i=toBind.length;i;)this.addEventListener(toBind[--i],handler,!1);else this.onmousewheel=handler},teardown:function(){if(this.removeEventListener)for(var i=toBind.length;i;)this.removeEventListener(toBind[--i],handler,!1);else this.onmousewheel=null}},$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}})});